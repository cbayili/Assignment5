@attribute [Authorize] //setting the page to require logging in
@page "/orderselect"
@using Models
<h3>Order Selection</h3>

<table class="table">
    <thead>
        <tr>
            <th>Customer ID</th>
            <th>Company Name</th>
            <th>Contact Name</th>
            <th>Phone</th>
            <th>Select</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var customer in customers) 
        {
            <tr>
                <td>@customer.CustomerId</td>
                <td>@customer.CompanyName</td>
                <td>@customer.ContactName</td>
                <td>@customer.Phone</td>
                <td>
                    <input type="radio" name="select" @onclick="@(e => RowClick(e,customer.CustomerId))">
                </td> 
            </tr>
            
        }
    </tbody>
</table>

@if (orders == null) 
   
{
    <p>
        <em>
            No orders shown at this
            time
        </em>
    </p>
}
else
{
<table class="table">
    
    <thead>
        <tr>
            <th>Order ID</th>
            <th>Order Date</th>
            <th>Shipped Date</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var order in orders) 
            
        if (order.CustomerId == Customid) 
            {
            <tr>
                <td>@order.OrderId</td>
                <td>@order.OrderDate</td>
                <td>@order.ShippedDate</td>
            </tr>
            }
        </tbody>
    </table>
    }
    @code {
    northwindContext db = new northwindContext();
    private string Customid= " "; 
    private List<Order> orders; //create the 2 lists
    private List<Customer> customers;
    protected override async Task OnInitializedAsync()
    {
        customers = db.Customers.ToList(); //populate dept on load
    }
    protected async Task RowClick(MouseEventArgs e, string CustomerId)
    {
        orders = db.Orders.ToList(); 
        Customid = CustomerId; 
    } 
}